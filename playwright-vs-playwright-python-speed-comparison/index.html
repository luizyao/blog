<!DOCTYPE html>
<html lang="zh-CN">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>Luiz&#x27;s Blog - 速度测试：playwright vs playwright-python</title>

      

      
          <!-- <script type="text/javascript" src="https://luizyao.github.io/blog/slideout.min.js" ></script> -->
          <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/index.min.js"></script>
          
          <!-- <script type="text/javascript" src="https://luizyao.github.io/blog/Valine.min.js" ></script> -->
          <script src="https://cdn.jsdelivr.net/npm/valine@1.4.18/dist/Valine.min.js" integrity="sha256-nPUdUfwNm4YBBhEYBxrSbW5DmfVODKCzs0nAp1Z3RnM=" crossorigin="anonymous"></script>
          
          
      

      
          <link rel="stylesheet" href="https://luizyao.github.io/blog/site.css">
          
      

      
      
    </head>

    <body>
        <div class="container">

            <div id="mobile-navbar" class="mobile-navbar">
              <div class="mobile-header-logo">
                <a href="/" class="logo">Luiz&#x27;s Blog</a>
              </div>
              <div class="mobile-navbar-icon icon-out">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>

            <nav id="mobile-menu" class="mobile-menu slideout-menu slideout-menu-left">
              <ul class="mobile-menu-list">
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;luizyao.github.io&#x2F;blog&#x2F;&#x2F;categories">
                            归档
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;luizyao.github.io&#x2F;blog&#x2F;&#x2F;tags">
                            标签
                        </a>
                    </li>
                
              </ul>
            </nav>

            <header id="header">
                <div class="logo"><a href="https:&#x2F;&#x2F;luizyao.github.io&#x2F;blog&#x2F;">Luiz&#x27;s Blog</a></div>
                <nav class="menu">
                    <ul>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;luizyao.github.io&#x2F;blog&#x2F;&#x2F;categories">
                                    归档
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;luizyao.github.io&#x2F;blog&#x2F;&#x2F;tags">
                                    标签
                                </a>
                            </li>
                        
                    </ul>
                </nav>
            </header>

            <main>
                <div class="content" id="mobile-panel">
                    


<div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">目录</h2>
    <div class="post-toc-content always-active">
        <nav id="TableOfContents">
            <ul>
                
                <li>
                    <a href="#ce-shi-fang-fa" class="toc-link">测试方法</a>
                    
                    <ul>
                        
                        <li>
                            <a href="#ji-ben-tiao-jian" class="toc-link">基本条件</a>
                        </li>
                        
                        <li>
                            <a href="#ce-shi-can-shu" class="toc-link">测试参数</a>
                        </li>
                        
                        <li>
                            <a href="#heng-liang-zhi-biao" class="toc-link">衡量指标</a>
                        </li>
                        
                        <li>
                            <a href="#shang-wei-heng-liang-de-zhi-biao" class="toc-link">尚未衡量的指标</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li>
                    <a href="#ce-shi-jie-guo" class="toc-link">测试结果</a>
                    
                    <ul>
                        
                        <li>
                            <a href="#jian-dan-de-chang-jing" class="toc-link">简单的场景</a>
                        </li>
                        
                        <li>
                            <a href="#fu-za-de-chang-jing" class="toc-link">复杂的场景</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li>
                    <a href="#jie-lun" class="toc-link">结论</a>
                    
                </li>
                
                <li>
                    <a href="#qi-ta" class="toc-link">其它</a>
                    
                </li>
                
            </ul>
        </nav>
    </div>
</div>


<article class="post">
    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;luizyao.github.io&#x2F;blog&#x2F;playwright-vs-playwright-python-speed-comparison&#x2F;">速度测试：playwright vs playwright-python</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2021-01-22</span>
            
            
                <div class="post__category">
                    
                        <a href="https://luizyao.github.io/blog/categories/qi-ta/">#其它</a>
                    
                </div>
            
            
                <span class="post__category leancloud_visitors" id="/blog/playwright-vs-playwright-python-speed-comparison/" data-flag-title="速度测试：playwright vs playwright-python">
                    <em class="post-meta-item-text"  style="font-style: normal;">· 阅读量 </em>
                    <i class="leancloud-visitors-count"  style="font-style: normal;">1000000</i>
                </span>
            
        </div>
    </header>

    <div class="post-content">
      <p>最近在网络上看到一篇文章：<a href="https://blog.checklyhq.com/puppeteer-vs-selenium-vs-playwright-speed-comparison/">puppeteer vs selenium vs playwright, a speed comparison</a>，作者是 <a href="https://www.checklyhq.com/">Checkly 团队</a>, 他们对 puppeteer、playwright 和 selenium 的执行速度做了量化的比较，得出的结论是 puppeteer 和 playwright 比 selenium 快了大概 20% 左右，有兴趣的同学可以看看。</p>
<p>受此启发，我对 <a href="https://github.com/microsoft/playwright">playwright</a> 和 <a href="https://github.com/microsoft/playwright-python">playwright-python</a> 也做了同样的测试。</p>
<span id="continue-reading"></span>
<p>playwright 是微软开源的浏览器自动化操作的 node.js 库，playwright-python 是它对应的官方 python 版本。</p>
<h2 id="ce-shi-fang-fa">测试方法</h2>
<p>如果你想直接了解测试结果，请跳过这一节。不过我仍然建议你继续阅读，以便于更好的理解测试结果的确切含义。</p>
<h3 id="ji-ben-tiao-jian">基本条件</h3>
<p>为了使测试对象尽可能的在相似的环境中运行，我们约定了以下基本条件：</p>
<ol>
<li><strong>资源平等</strong>：每个测试都是在同一台“静止的”机器上依次执行的，也就是说，在测试期间，后台没有发生繁重的工作负载。</li>
<li><strong>简单执行</strong>：脚本的执行方式如每个工具的“入门”文档所示。例如：playwright 的 <code>node script.js</code>，并且尽量使用默认的命令行选项。</li>
<li><strong>相似的脚本</strong>：尽量减小测试中不同工具之间编写脚本的差异。</li>
<li><strong>最新版本</strong>：测试对象都使用目前为止发布的最新版本。</li>
<li><strong>相同的浏览器</strong>：所有的脚本都在无头模式的 Chromium 浏览器上执行。</li>
</ol>
<p>所有条件的细节，请参阅下一节。</p>
<h3 id="ce-shi-can-shu">测试参数</h3>
<p>每个测试脚本都<strong>成功的连续执行 1000 次</strong>。</p>
<p>测试对象的版本信息如下：</p>
<ul>
<li>playwright：1.8.0</li>
<li>playwright-python：1.8.0a1</li>
</ul>
<h3 id="heng-liang-zhi-biao">衡量指标</h3>
<p>对每个测试都衡量以下几个指标，它们都是从这 1000 次的执行结果中计算出来的：</p>
<ul>
<li><strong>平均执行时间</strong>（秒）</li>
<li><strong>标准差</strong>（秒）：方差的算术平方根，反应执行时间的离散程度。</li>
<li><strong>相对标准偏差</strong>：标准差除以平均值再乘以 100%，反应执行时间相对于平均值的波动程度。</li>
<li><strong>P95</strong>：丢弃最慢的 5% 的数据，剩下的耗时最长的结果，反应非极端情况下仍然较长的执行时间。</li>
</ul>
<h3 id="shang-wei-heng-liang-de-zhi-biao">尚未衡量的指标</h3>
<ul>
<li><strong>可靠性</strong>：不可靠的脚本即使执行的再快也是毫无意义的。</li>
<li><strong>并行执行</strong>：对自动化工具而言，并行执行是一个很重要的概念。但是，本次测试首要关注的是单个脚本的执行速度。</li>
<li><strong>非本地执行</strong>：和并行化一样，脚本的远程执行也是一个重要的话题，但同样不在本文的讨论范围之内。</li>
<li><strong>资源耗用</strong>：执行测试耗用的内存和 CPU 计算同样未予考虑。</li>
</ul>
<h2 id="ce-shi-jie-guo">测试结果</h2>
<p>为了避免网络延迟带来的影响，脚本操作的是我之前在<a href="https://luizyao.com/blog/post/2020-12-06-pi-hole-getting-started-on-raspberry-pi/">本地的树莓派上搭建的 pihole 服务</a>。</p>
<h3 id="jian-dan-de-chang-jing">简单的场景</h3>
<p>在这个场景中，脚本执行一个 pi-hole 的快速登录操作，预计只需要几秒钟，这可以明显的区分出测试对象启动速度之间的差异。</p>
<p>以下是我们的汇总测试结果：</p>
<p><img src="https://luizyao.github.io/blog/playwright-vs-playwright-python-speed-comparison/simple-scenario.png" alt="登录 pihole 的测试结果" /></p>
<p>在这种场景下，playwright 比 playwright-python 的速度快了 20% 以上，但是 playwright-python 拥有更低的离散度和变异性。</p>
<p><img src="https://luizyao.github.io/blog/playwright-vs-playwright-python-speed-comparison/discreteness-and-variability-comparison-for-simple-scenario.png" alt="login pihole: playwright vs playwright-python" /></p>
<h3 id="fu-za-de-chang-jing">复杂的场景</h3>
<p>在这个场景中，我们登录 pihole 添加一个黑名单和白名单，然后再删除它们。我们来看看在这种稍微复杂的场景中，是否还能得到上面的结论。</p>
<p>以下是我们的汇总测试结果：</p>
<p><img src="https://luizyao.github.io/blog/playwright-vs-playwright-python-speed-comparison/complex-scenario.png" alt="管理 pinhole 的测试结果" /></p>
<p>这里 playwright 相对于 playwright-python 的速度优势降到了 10% 左右，但同时它们的离散度和差异性趋于重合。</p>
<p><img src="https://luizyao.github.io/blog/playwright-vs-playwright-python-speed-comparison/discreteness-and-variability-comparison-for-complex-scenario.png" alt="manage pihole: playwright vs playwright-python" /></p>
<h2 id="jie-lun">结论</h2>
<p>playwright 确实相对于 playwright-python 有执行速度上的优势，在一些脚本操作简单，执行时间短的场景中有 20% 以上的优势，但是对于一些复杂的、执行时间较长的场景，优势大概在 10% 左右。</p>
<p>其实，不管是对于 playwright、puppeteer 还是 selenium，速度永远都不是在选择工具时的第一考虑要素，更要考虑到自身的需求、脚本开发的效率等等。</p>
<p><strong>以上结论仅供参考</strong>。</p>
<h2 id="qi-ta">其它</h2>
<p>本文所有的测试脚本、测试结果都可以在这个<a href="https://github.com/luizyao/headless-benchmarks">仓库</a>中找到，包括自动计算结果，并生成本文所有表格、图片的一个脚本，在写这个脚本的时候，还发现了 rich 的一个 <a href="https://github.com/willmcgugan/rich/issues/953">BUG</a>，也算是一个意外的收获吧。</p>
<blockquote>
<p><a href="https://github.com/willmcgugan/rich">rich</a> 是一个 python 库，能够在终端打印漂亮的输出，Github 上超过 2 万 star，有兴趣的可以试试。</p>
</blockquote>

    </div>

    
    

    <div class="post-footer">
        
            
                <div class="post-tags">
                    
                        <a href="https://luizyao.github.io/blog/tags/playwright/">#playwright</a>
                    
                </div>
            
            

        

    </div>

    <div class="post-footer">
    
    
    </div>

    
        <div id="vcomments"></div>
        <script>
            new Valine({
                el: '#vcomments',
                appId: 'ELAxhd0CdYZzYItFv1aOgfkU-gzGzoHsz',
                appKey: 'Dn5ewE2hhnJwQXe1LsucljYV',
                visitor: true // 阅读量统计
            })
        </script>
    
</article>


                </div>
            </main>

            
            <div style="text-align: center;">
                <span class="author">
                    © 2020-2025 Luiz Yao
                </span>
                 &nbsp;|&nbsp;
                <span class="license">
                    <a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh-Hans" target="_blank">CC BY-NC 4.0</a>
                </span>
            </div>
            
        </div>

      
          <script type="text/javascript" src="https://luizyao.github.io/blog/even.js" ></script>
      
    </body>

</html>
